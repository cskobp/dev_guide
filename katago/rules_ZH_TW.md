# KataGo 支援的圍棋規則 (KataGo's Supported Go Rules)

本文檔描述了 KataGo 實現的嚴格規則集（第 2 版）。這些規則旨在夠嚴格，以便機器人可以用於自對弈或比賽，而無需外部裁決。

## 參數 (Parameters)

KataGo 的規則具有高度可配置性，主要參數包括：

*   **Rules (規則集簡寫)**: 如 `chinese` (中國規則), `japanese` (日本規則), `aga` (美國圍棋協會規則), `tromp-taylor`, `new-zealand` (紐西蘭規則) 等。這些簡寫是對下列詳細參數的預設組合。

### 詳細參數說明

1.  **KoRule (劫爭規則)**
    *   **Simple (簡單劫)**: 禁止回復到對手上一手開始時的局面。
    *   **Positional Superko (局面超劫/全同再現)**: 禁止回復到之前的任何局面。
    *   **Situational Superko (形勢超劫)**: 禁止回復到之前的任何局面（也考慮輪到誰下）。

2.  **ScoringRule (計分規則)**
    *   **Area (數子法/區域計分)**: 計算棋盤上的子數 + 圍住的空點（類似中國規則）。
    *   **Territory (數目法/領地計分)**: 計算死子 + 圍住的空點（類似日本規則）。

3.  **TaxRule (貼目/稅收規則)**
    *   **None**: 圍住的空點總是計算在內。
    *   **Seki**: 雙活 (Seki) 中的空點不計分（類似日本規則）。
    *   **All**: 所有活棋組都被徵收 2 點稅（即需要兩個眼位），這使得數子法在數學上等同於數目法。

4.  **MultiStoneSuicide (多子自殺)**
    *   **Allowed**: 允許自殺（只要能清空對手的子，或者規則允許純粹自殺）。注：KataGo 規則中，單純殺死剛下的子而無其他影響的自殺總是被禁止的。
    *   **Disallowed**: 禁止多子自殺。

5.  **Button (按鈕)**
    *   **Used**: 實現「按鈕圍棋」，即第一個通過 (Pass) 的玩家獲得 0.5 分。這稍微獎勵了官子效率。
    *   **Not Used**: 不使用按鈕。

6.  **WhiteHandicapBonus (白棋讓子補償)**
    *   在讓子棋中，白棋獲得的額外補償點數：`0`, `N-1`, 或 `N` (N 為黑棋讓子數)。

---

## 規則詳情 (Rules Details)

### 基本定義

*   圍棋由兩名玩家（黑方和白方）在 X * Y 的網格上進行。
*   **擬合法移動 (Pseudolegal move)**: 放置一顆子，提掉對手無氣的子，提掉自己無氣的子（若允許自殺）。必須改變局面。

### 主要階段 (Main Phase)

*   玩家輪流下棋或虛手 (Pass)。
*   **結束條件**:
    *   連續兩次虛手（若使用 Button 則可能需要更多次）。
    *   如果是 Simple Ko，如果出現長循環（如雙劫循環），可能會被判定為無結果或結束。
    *   如果啟用了 SelfPlayOpts，當所有點都屬於「活棋」或「活棋領地」時，階段也可能結束。

### 計分與清理階段 (Scoring and Cleanup Phases)

*   **數子法 (Area Scoring)**:
    *   遊戲結束後直接計算：(己方棋子數 + 己方圍住的空點數)。
    *   根據 `TaxRule` 可能會有扣除（如雙活無目）。
    *   白棋加上貼目 (Komi)。

*   **數目法 (Territory Scoring)** (清理階段):
    *   主要階段結束後，進入**清理階段**。
    *   清理階段旨在模擬日本規則的死活判定，允許玩家實際提掉死子而不損失點數（每手棋獲得補償）。
    *   包含兩個子階段，處理劫爭規則的變更和清理。
    *   最終分數 = (圍住的空點 + 提子數 + 清理階段的落子補償 - 損失的點 - 雙活稅等)。

### 關於日本規則的特別說明

KataGo 的規則試圖形式化日本規則的精神，以便進行嚴格的計算機自對弈。
*   **盤角曲四 (Bent-four-in-the-corner)**: 在這些規則下，如果雙方都為了最大化分數而下，盤角曲四是死棋。
*   **雙活無目 (No territory in seki)**: 數目法下實現了雙活無目。
*   **假生 (Three-points-without-capturing)**: 在此規則下通常自然地判定為不需要提子（即假生狀態），但與現代日本規則將其視為雙活不同。

---
*文件生成時間: 2026-01-22*
